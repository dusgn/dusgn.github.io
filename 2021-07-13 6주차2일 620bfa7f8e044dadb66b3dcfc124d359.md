# 2021-07-13 6주차2일

목표

- [x]  테스트 ArticleService중 메서드 선택해서 코드 작성하기
- [x]  게시판 UI 구현 완성하기(제발...)
- [x]  로그인 회원가입 스프링 시큐리티로 구현하기

#1 ArticleService클래스의 update 테스트 작성

테스트가 감이 잘 안잡힌다. 

어떤 메서드를 테스트 할지 정하고 그 범위를 어디까지 생각해야 될지 모르겠어서 일단 강의에서 나온대로 단위테스트를 진행했다.

Mockito를 사용해 ArticleRepository 를 목으로 주입받고

```java
when(articleRepository.findById(id))
        .thenReturn(Optional.of(article));
```

실제로id 값이 저장되어있는게 아니니 articleRepository.findbyId가Optional<T> findById(ID id); 로 Optional로 반환됨을 알려주었다.

그리고

dto를 만들어줘야되서

```java
ArticleCreateRequestDto createrequestDto = new ArticleCreateRequestDto("hello","hello","hello");
```

생성자를 위해 @AllArgsConstructor를 추가해주었다.

```java
ArticleUpdateRequestDto updateRequestDto = new ArticleUpdateRequestDto(title, content);
```

업데이트를 위해서도 updateDto에도 @AllArgsConstructor를 추가해주었다.

그리고 테스트를 하니 

기본 생성자가 없어서 나는 오류를 발견해 둘다

@NoArgsConstructor도 각각 추가해 주었다

흠... 일단 

AllArgsConstructor 는 전체 필드를 파라미터로 포함한 생성자를 만들어 주기때문에

위에처럼 사용하려면 넣어주는 걸로 이해했고

NoArgsConstructor는 자바에선 생성자가 선언되면 기본생성자는 JVM이 넣어주지 않아 오류가 난것으로 이해하고 넘어가야겠다.

[https://lkhlkh23.tistory.com/159](https://lkhlkh23.tistory.com/159)

그런데 여러 블로그에서 @AllArgsConstructor, @RequiredArgsContstructor 사용을 하지말라고 권장한다.

- @AllArgsConstructor : 객체 내부의 인스턴스멤버들을 모두 가지고 있는 생성자를 생성하는 Lombok 어노테이션

- @RequiredArgsConstructor : 객체 내부의 final, @Notnull 이 붙은 인스턴스멤버들을 가지고 있는 생성자를 생성하는 Lombok 어노테이션

두 어노테이션은 인스턴스 멤버의 순서가 중요하다. 왜냐하면 인스턴스 멤버의 순서가 생성자의 파라미터의 순서와 동일하기 때문이다.

그렇기 때문에 Person이라는 객체를 생성하기 위해서는 'Person person = new Person("LEE", "DOBY); 로 생성을 해야한다.

그러나 만약, 리팩토링을 하면서 혹은 타인에 의해 해당 인스턴스 멤버의 순서가 바뀌어버리면 어떻게 될까?! 두 인스턴스 멤버는 동일한 타입이기 때문에 컴파일 시, 오류는 발생하지 않는다. 오류가 발생하지 않기 때문에 그냥 지나칠 수 있다. 하지만, 나는 성과 이름이 바뀌게 된다. 그래서 되도록이면, @Builder 어노테이션을 이용하는 것을 권장한다.

그리고 @Builder를 이용해서 객체를 생성하면 코드를 읽을 때, 객체에 대한 대략적인 파악도 가능하고 순서에 의존적이지 않기 때문에 @Builder를 권장한다.

아직 Builder를 사용할 수준은 아니라고 판단해서 알고만 넘어간다.

혼자하는 프로젝트에선 필드의 순서를 알고있어서 괜찮지만 여럿이 하는 프로젝트를 위해 빨리 ... builder패턴을 익히는 걸로!

#2 오늘은 UI 삽질많이했다... 힘들다...